<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDP Rank Booster</title>
    <style>
        :root {
            color-scheme: light;
            --bg: #f5f7fb;
            --panel: #ffffff;
            --text: #1b1f24;
            --muted: #667085;
            --primary: #2563eb;
            --green: #16a34a;
            --yellow: #f59e0b;
            --red: #dc2626;
            --border: #e4e7ec;
            --shadow: 0 12px 25px rgba(15, 23, 42, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Inter", "Segoe UI", system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
        }

        .app {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 260px;
            background: #0f172a;
            color: #e2e8f0;
            padding: 28px 22px;
            position: sticky;
            top: 0;
            height: 100vh;
        }

        .sidebar h1 {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .sidebar p {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-bottom: 32px;
        }

        .nav {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .nav a {
            color: #e2e8f0;
            text-decoration: none;
            padding: 10px 12px;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: background 0.2s ease;
        }

        .nav a:hover {
            background: rgba(148, 163, 184, 0.2);
        }

        .content {
            flex: 1;
            padding: 32px 40px 60px;
        }

        .topbar {
            background: var(--panel);
            border-radius: 18px;
            padding: 18px 24px;
            box-shadow: var(--shadow);
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 28px;
        }

        .topbar-left {
            display: flex;
            flex: 1;
            gap: 12px;
            align-items: center;
        }

        .topbar input {
            flex: 1;
            min-width: 220px;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: #f8fafc;
        }

        .btn {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 10px 16px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn.secondary {
            background: #0f172a;
        }

        .btn.ghost {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 12px rgba(37, 99, 235, 0.2);
        }

        .scan-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: var(--muted);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--green);
        }

        .section {
            margin-bottom: 36px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .section-header h2 {
            font-size: 1.3rem;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
        }

        .card {
            background: var(--panel);
            border-radius: 16px;
            padding: 18px;
            box-shadow: var(--shadow);
        }

        .metric {
            font-size: 2rem;
            font-weight: 700;
            margin-top: 6px;
        }

        .delta {
            margin-top: 8px;
            font-size: 0.9rem;
        }

        .delta.green { color: var(--green); }
        .delta.yellow { color: var(--yellow); }
        .delta.red { color: var(--red); }

        .pill {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            color: #fff;
            display: inline-block;
        }

        .pill.green { background: var(--green); }
        .pill.yellow { background: var(--yellow); }
        .pill.red { background: var(--red); }

        .table-wrapper {
            background: var(--panel);
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 16px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th, td {
            text-align: left;
            padding: 12px 10px;
            border-bottom: 1px solid var(--border);
            vertical-align: top;
        }

        th {
            color: var(--muted);
            font-weight: 600;
            cursor: pointer;
        }

        tbody tr:hover {
            background: #f8fafc;
        }

        .table-tools {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            gap: 12px;
            flex-wrap: wrap;
        }

        .table-tools input {
            padding: 8px 10px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: #f8fafc;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .book-row {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .cover {
            width: 54px;
            height: 72px;
            border-radius: 8px;
            background: linear-gradient(135deg, #e2e8f0, #cbd5f5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #64748b;
        }

        .tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .tag {
            border-radius: 8px;
            padding: 4px 8px;
            background: #eef2ff;
            color: #4338ca;
            font-size: 0.75rem;
        }

        .checklist {
            list-style: none;
            display: grid;
            gap: 10px;
        }

        .checklist li {
            display: flex;
            justify-content: space-between;
            padding: 10px 12px;
            background: #f8fafc;
            border-radius: 10px;
        }

        .status-indicator {
            font-weight: 600;
        }

        .status-indicator.good { color: var(--green); }
        .status-indicator.warn { color: var(--yellow); }
        .status-indicator.bad { color: var(--red); }

        .idea-card {
            background: #f8fafc;
            border-radius: 16px;
            padding: 16px;
            border: 1px solid var(--border);
        }

        .idea-card h4 {
            margin-bottom: 6px;
        }

        .status-pill {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid var(--border);
            background: #fff;
        }

        .status-pill.todo { color: var(--red); }
        .status-pill.progress { color: var(--yellow); }
        .status-pill.done { color: var(--green); }

        .footer-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .data-flow {
            display: grid;
            gap: 12px;
        }

        .data-flow-step {
            background: #f8fafc;
            border-radius: 12px;
            padding: 12px 14px;
            border-left: 4px solid var(--primary);
        }

        @media (max-width: 1024px) {
            .app {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
        }

        @media (max-width: 720px) {
            .content {
                padding: 24px;
            }

            .topbar {
                flex-direction: column;
                align-items: stretch;
            }

            .topbar-left {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <h1>KDP Rank Booster</h1>
            <p>Dashboard analityczny dla autorów Amazon KDP.</p>
            <nav class="nav">
                <a href="#overview">Overview</a>
                <a href="#niche-analysis">Analiza niszy</a>
                <a href="#niche-detail">Szczegóły niszy</a>
                <a href="#competition">Analiza konkurencji</a>
                <a href="#keywords">Słowa kluczowe</a>
                <a href="#ideas">Generator pomysłów</a>
                <a href="#audit">Audyt ebooka</a>
                <a href="#monitor">Monitor nisz</a>
                <a href="#export">Eksport</a>
            </nav>
        </aside>

        <main class="content">
            <section class="topbar">
                <div class="topbar-left">
                    <input type="text" placeholder="Słowo kluczowe / kategoria KDP">
                    <button class="btn">Skanuj niszę</button>
                    <button class="btn secondary">Dodaj ASIN</button>
                </div>
                <div class="scan-status">
                    <span class="status-dot"></span>
                    Status skanu: aktywny · ostatnia aktualizacja 2 min temu
                </div>
            </section>

            <section class="section" id="overview">
                <div class="section-header">
                    <h2>Strona główna – Overview</h2>
                </div>
                <div class="card-grid">
                    <div class="card">
                        <span class="pill green">Aktywne nisze</span>
                        <div class="metric">12</div>
                        <div class="delta green">▲ +3% tygodniowo</div>
                    </div>
                    <div class="card">
                        <span class="pill yellow">Twoje ebooki</span>
                        <div class="metric">6</div>
                        <div class="delta yellow">▲ +1 nowy draft</div>
                    </div>
                    <div class="card">
                        <span class="pill green">Pomysły do wydania</span>
                        <div class="metric">18</div>
                        <div class="delta green">▲ +4 nowe pomysły</div>
                    </div>
                    <div class="card">
                        <span class="pill red">Nisze wchodzące</span>
                        <div class="metric">4</div>
                        <div class="delta red">▼ -2% momentum</div>
                    </div>
                </div>
            </section>

            <section class="section" id="niche-analysis">
                <div class="section-header">
                    <h2>Analiza niszy</h2>
                </div>
                <div class="table-wrapper">
                    <div class="table-tools">
                        <input id="nicheFilter" type="text" placeholder="Filtruj nisze, kategorie, konkurencję...">
                        <button class="btn ghost" onclick="resetFilters('niche')">Wyczyść filtry</button>
                    </div>
                    <table id="nicheTable">
                        <thead>
                            <tr>
                                <th data-key="phrase">Fraza / nisza</th>
                                <th data-key="category">Kategoria</th>
                                <th data-key="bsr">Średni BSR TOP 10</th>
                                <th data-key="reviews">Średnia liczba recenzji</th>
                                <th data-key="price">Zakres cen</th>
                                <th data-key="competition">Ocena konkurencji</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <section class="section" id="niche-detail">
                <div class="section-header">
                    <h2>Widok szczegółowy niszy</h2>
                    <span class="pill green" id="detailStatus">Status: zielony</span>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3 id="detailName">Minimalistyczny planer finansowy</h3>
                        <p style="margin-top: 8px; color: var(--muted);">Rekomendacja: <strong id="detailRec">wchodzić</strong></p>
                        <div class="tags" id="detailTags"></div>
                        <div class="data-flow" style="margin-top: 16px;">
                            <div class="data-flow-step">Kryterium: BSR TOP10 &lt; 15k, recenzje &lt; 200.</div>
                            <div class="data-flow-step">Sygnalizuje rosnące zapotrzebowanie w segmencie planowania budżetu.</div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>TOP ebooki w niszy</h3>
                        <div class="table-wrapper" style="box-shadow: none; padding: 0;">
                            <table id="topBooksTable">
                                <thead>
                                    <tr>
                                        <th>Okładka</th>
                                        <th>Tytuł</th>
                                        <th>BSR</th>
                                        <th>Recenzje</th>
                                        <th>Cena</th>
                                        <th>Data</th>
                                        <th>Format</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section" id="competition">
                <div class="section-header">
                    <h2>Analiza konkurencji</h2>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <div class="book-row">
                            <div class="cover">KDP</div>
                            <div>
                                <h3>Budget Reset: 30 dni do spłaty długów</h3>
                                <p style="color: var(--muted);">Podtytuł: Przewodnik po planowaniu finansów osobistych</p>
                            </div>
                        </div>
                        <div style="margin-top: 16px; line-height: 1.6; color: var(--muted);">
                            <p><strong>Liczba stron:</strong> 144</p>
                            <p><strong>Cena:</strong> 8,99 USD</p>
                            <p><strong>Kategorie:</strong> Personal Finance, Budgeting, Self-Help</p>
                        </div>
                        <div class="tags">
                            <span class="tag">Słowa kluczowe: budget reset</span>
                            <span class="tag">nawyki finansowe</span>
                            <span class="tag">planer wydatków</span>
                        </div>
                        <h4 style="margin-top: 16px;">Opis (podzielony na bloki)</h4>
                        <ul style="margin-top: 8px; padding-left: 18px; color: var(--muted);">
                            <li>Wprowadzenie do problemu zadłużenia.</li>
                            <li>Prosta metodologia 30-dniowa.</li>
                            <li>Checklisty i ćwiczenia do druku.</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>Wnioski</h3>
                        <ul style="margin-top: 12px; padding-left: 18px; color: var(--muted);">
                            <li><strong>Dlaczego rankuje:</strong> konkretna obietnica (30 dni) i niski próg wejścia.</li>
                            <li><strong>Co robi dobrze:</strong> silny podtytuł, jasny problem i checklisty.</li>
                            <li><strong>Co można zrobić lepiej:</strong> więcej case studies i bonusowy arkusz budżetu.</li>
                        </ul>
                        <div class="data-flow" style="margin-top: 16px;">
                            <div class="data-flow-step">Sygnały rankingu: rosnąca liczba recenzji i dobre CTR z frazy "budget reset".</div>
                            <div class="data-flow-step">Rekomendacja: pozycjonować się na "budget reset workbook".</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section" id="keywords">
                <div class="section-header">
                    <h2>Słowa kluczowe</h2>
                </div>
                <div class="table-wrapper">
                    <div class="table-tools">
                        <input id="keywordFilter" type="text" placeholder="Filtruj frazy lub źródła...">
                        <button class="btn ghost" onclick="resetFilters('keyword')">Wyczyść filtry</button>
                    </div>
                    <table id="keywordTable">
                        <thead>
                            <tr>
                                <th data-key="phrase">Fraza</th>
                                <th data-key="source">Źródło</th>
                                <th data-key="competition">Konkurencja</th>
                                <th data-key="usage">Rekomendowane użycie</th>
                                <th>Eksport</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <section class="section" id="ideas">
                <div class="section-header">
                    <h2>Generator pomysłów na ebooki</h2>
                </div>
                <div class="card-grid" id="ideasGrid"></div>
            </section>

            <section class="section" id="audit">
                <div class="section-header">
                    <h2>Audyt ebooka</h2>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <label for="auditInput" style="font-weight: 600;">ASIN</label>
                        <input id="auditInput" type="text" placeholder="B0CEXAMPLE" style="margin-top: 10px; width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid var(--border);">
                        <button class="btn" style="margin-top: 12px;">Uruchom audyt</button>
                        <div class="data-flow" style="margin-top: 16px;">
                            <div class="data-flow-step">Pobranie metadanych i wykrycie fraz w tytule/opisie.</div>
                            <div class="data-flow-step">Walidacja kategorii vs konkurencja.</div>
                            <div class="data-flow-step">Generowanie checklisty i rekomendacji.</div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>Checklist</h3>
                        <ul class="checklist" style="margin-top: 12px;">
                            <li> Tytuł zawiera frazę <span class="status-indicator good">✔ OK</span></li>
                            <li> Podtytuł sprzedaje <span class="status-indicator warn">⚠ do poprawy</span></li>
                            <li> Opis ma strukturę <span class="status-indicator good">✔ OK</span></li>
                            <li> Kategorie są dobrze dobrane <span class="status-indicator warn">⚠ do poprawy</span></li>
                            <li> Słowa kluczowe się nie dublują <span class="status-indicator bad">✖ konflikt</span></li>
                        </ul>
                        <div style="margin-top: 14px; color: var(--muted);">
                            <strong>Rekomendacje:</strong>
                            <ul style="margin-top: 8px; padding-left: 18px;">
                                <li>Wzmocnij podtytuł o konkretne korzyści.</li>
                                <li>Dodaj dwie niszowe frazy w backend keywords.</li>
                                <li>Zmień drugorzędną kategorię na "Budgeting Workbooks".</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section" id="monitor">
                <div class="section-header">
                    <h2>Monitor nisz</h2>
                </div>
                <div class="table-wrapper">
                    <div class="table-tools">
                        <input id="monitorFilter" type="text" placeholder="Filtruj nisze...">
                        <button class="btn ghost" onclick="resetFilters('monitor')">Wyczyść filtry</button>
                    </div>
                    <table id="monitorTable">
                        <thead>
                            <tr>
                                <th data-key="niche">Nisza</th>
                                <th data-key="bsrChange">Zmiana BSR</th>
                                <th data-key="newBooks">Nowe ebooki</th>
                                <th data-key="reviewVelocity">Tempo recenzji</th>
                                <th data-key="alert">Alert</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <section class="section" id="export">
                <div class="section-header">
                    <h2>Eksport</h2>
                </div>
                <div class="card">
                    <p style="color: var(--muted);">Eksportuj listy nisz, słów kluczowych i monitoringu do CSV lub Google Sheets.</p>
                    <div class="footer-actions" style="margin-top: 16px;">
                        <button class="btn">Eksport do CSV</button>
                        <button class="btn secondary">Eksport do Google Sheets</button>
                    </div>
                </div>
            </section>

            <section class="section" id="data-flow">
                <div class="section-header">
                    <h2>Logika przepływu danych</h2>
                </div>
                <div class="card">
                    <div class="data-flow">
                        <div class="data-flow-step"><strong>Wejście:</strong> słowa kluczowe, ASIN, dane z Amazon KDP + trendów.</div>
                        <div class="data-flow-step"><strong>Analiza:</strong> scoring nisz (BSR, recenzje, ceny, tempo recenzji).</div>
                        <div class="data-flow-step"><strong>Insight:</strong> rekomendacje nisz + audyt ebooków.</div>
                        <div class="data-flow-step"><strong>Akcja:</strong> generator pomysłów + eksport list do planu wydawniczego.</div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        const nicheData = [
            {
                phrase: "Minimalistyczny planer finansowy",
                category: "Personal Finance > Budgeting",
                bsr: 8200,
                reviews: 118,
                price: "6.99 - 9.99 USD",
                competition: "niska",
                status: "green",
                recommendation: "wchodzić",
                tags: ["trend +12%", "niska konkurencja", "wysoki CTR"],
                topBooks: [
                    { title: "Zero Debt Planner", bsr: 5200, reviews: 189, price: "8.99", date: "2023-11", format: "paperback" },
                    { title: "Budget Reset Workbook", bsr: 9100, reviews: 112, price: "7.99", date: "2024-02", format: "paperback" },
                    { title: "Simple Spending Tracker", bsr: 13200, reviews: 75, price: "6.49", date: "2023-09", format: "hardcover" }
                ]
            },
            {
                phrase: "Journaling dla mam",
                category: "Self-Help > Journaling",
                bsr: 17600,
                reviews: 240,
                price: "7.49 - 11.99 USD",
                competition: "średnia",
                status: "yellow",
                recommendation: "testować",
                tags: ["stabilny popyt", "wysoka lojalność"],
                topBooks: [
                    { title: "Mom Mindset Journal", bsr: 14800, reviews: 280, price: "9.49", date: "2022-12", format: "paperback" },
                    { title: "Mindful Mothering", bsr: 18200, reviews: 210, price: "10.99", date: "2023-05", format: "paperback" },
                    { title: "Daily Mom Notes", bsr: 21000, reviews: 156, price: "7.99", date: "2023-08", format: "spiral" }
                ]
            },
            {
                phrase: "Workbook ADHD dla dorosłych",
                category: "Health > Mental Health",
                bsr: 29800,
                reviews: 410,
                price: "9.99 - 14.99 USD",
                competition: "wysoka",
                status: "red",
                recommendation: "odpuścić",
                tags: ["wysoka konkurencja", "trend +3%"],
                topBooks: [
                    { title: "Adult ADHD Focus", bsr: 25000, reviews: 540, price: "12.99", date: "2022-06", format: "paperback" },
                    { title: "ADHD Mastery", bsr: 27000, reviews: 480, price: "13.99", date: "2021-10", format: "paperback" },
                    { title: "Focus Planner", bsr: 31000, reviews: 390, price: "9.99", date: "2023-01", format: "paperback" }
                ]
            }
        ];

        const keywordData = [
            { phrase: "budget reset workbook", source: "tytuł", competition: "niska", usage: "tytuł" },
            { phrase: "planer finansowy miesięczny", source: "opis", competition: "średnia", usage: "backend" },
            { phrase: "spłata długów krok po kroku", source: "opis", competition: "niska", usage: "opis" },
            { phrase: "minimalistyczny budżet", source: "inne", competition: "średnia", usage: "backend" },
            { phrase: "journaling dla mam", source: "tytuł", competition: "wysoka", usage: "tytuł" }
        ];

        const ideasData = [
            {
                title: "Budget Reset Planner",
                subtitle: "30 dni do odzyskania kontroli",
                audience: "Młodzi profesjonaliści",
                pages: "120-150",
                price: "8.99 USD",
                competition: "niska",
                status: "do zrobienia"
            },
            {
                title: "Mindful Mom Journal",
                subtitle: "Codzienne rytuały spokoju",
                audience: "Mamy 25-40",
                pages: "160",
                price: "10.99 USD",
                competition: "średnia",
                status: "w trakcie"
            },
            {
                title: "Finance Habit Tracker",
                subtitle: "Nawyki, które budują kapitał",
                audience: "Nowi freelancerzy",
                pages: "96",
                price: "7.99 USD",
                competition: "niska",
                status: "wydane"
            }
        ];

        const monitorData = [
            { niche: "Minimalistyczny planer finansowy", bsrChange: "-12%", newBooks: 3, reviewVelocity: "+18%", alert: "wchodzi" },
            { niche: "Journaling dla mam", bsrChange: "+2%", newBooks: 1, reviewVelocity: "+4%", alert: "stabilnie" },
            { niche: "Workbook ADHD dla dorosłych", bsrChange: "+9%", newBooks: 6, reviewVelocity: "+2%", alert: "spada" }
        ];

        const nicheTableBody = document.querySelector("#nicheTable tbody");
        const keywordTableBody = document.querySelector("#keywordTable tbody");
        const monitorTableBody = document.querySelector("#monitorTable tbody");
        const ideasGrid = document.getElementById("ideasGrid");
        const topBooksTableBody = document.querySelector("#topBooksTable tbody");

        const state = {
            nicheSortKey: null,
            nicheSortDir: 1,
            keywordSortKey: null,
            keywordSortDir: 1,
            monitorSortKey: null,
            monitorSortDir: 1,
            activeNiche: nicheData[0]
        };

        const formatCompetition = (value) => {
            if (value === "niska") return "green";
            if (value === "średnia") return "yellow";
            return "red";
        };

        function renderNicheTable(data) {
            nicheTableBody.innerHTML = data.map(item => `
                <tr data-phrase="${item.phrase}">
                    <td><strong>${item.phrase}</strong></td>
                    <td>${item.category}</td>
                    <td>${item.bsr.toLocaleString("pl-PL")}</td>
                    <td>${item.reviews}</td>
                    <td>${item.price}</td>
                    <td><span class="pill ${formatCompetition(item.competition)}">${item.competition}</span></td>
                </tr>
            `).join("");

            nicheTableBody.querySelectorAll("tr").forEach(row => {
                row.addEventListener("click", () => {
                    const phrase = row.dataset.phrase;
                    const selected = nicheData.find(item => item.phrase === phrase);
                    if (selected) {
                        state.activeNiche = selected;
                        renderNicheDetail();
                    }
                });
            });
        }

        function renderNicheDetail() {
            const detail = state.activeNiche;
            const detailName = document.getElementById("detailName");
            const detailRec = document.getElementById("detailRec");
            const detailTags = document.getElementById("detailTags");
            const detailStatus = document.getElementById("detailStatus");

            detailName.textContent = detail.phrase;
            detailRec.textContent = detail.recommendation;
            detailTags.innerHTML = detail.tags.map(tag => `<span class="tag">${tag}</span>`).join("");

            detailStatus.className = `pill ${detail.status}`;
            detailStatus.textContent = `Status: ${detail.status === "green" ? "zielony" : detail.status === "yellow" ? "żółty" : "czerwony"}`;

            topBooksTableBody.innerHTML = detail.topBooks.map(book => `
                <tr>
                    <td><div class="cover">${book.title.slice(0, 2).toUpperCase()}</div></td>
                    <td>${book.title}</td>
                    <td>${book.bsr.toLocaleString("pl-PL")}</td>
                    <td>${book.reviews}</td>
                    <td>${book.price} USD</td>
                    <td>${book.date}</td>
                    <td>${book.format}</td>
                </tr>
            `).join("");
        }

        function renderKeywordTable(data) {
            keywordTableBody.innerHTML = data.map(item => `
                <tr>
                    <td>${item.phrase}</td>
                    <td>${item.source}</td>
                    <td><span class="pill ${formatCompetition(item.competition)}">${item.competition}</span></td>
                    <td>${item.usage}</td>
                    <td><input type="checkbox"></td>
                </tr>
            `).join("");
        }

        function renderMonitorTable(data) {
            monitorTableBody.innerHTML = data.map(item => `
                <tr>
                    <td>${item.niche}</td>
                    <td>${item.bsrChange}</td>
                    <td>${item.newBooks}</td>
                    <td>${item.reviewVelocity}</td>
                    <td><span class="pill ${item.alert === "wchodzi" ? "green" : item.alert === "spada" ? "red" : "yellow"}">${item.alert}</span></td>
                </tr>
            `).join("");
        }

        function renderIdeas() {
            ideasGrid.innerHTML = ideasData.map(idea => `
                <div class="idea-card">
                    <h4>${idea.title}</h4>
                    <p style="color: var(--muted); margin-bottom: 8px;">${idea.subtitle}</p>
                    <p><strong>Grupa docelowa:</strong> ${idea.audience}</p>
                    <p><strong>Strony:</strong> ${idea.pages}</p>
                    <p><strong>Cena:</strong> ${idea.price}</p>
                    <p><strong>Konkurencja:</strong> ${idea.competition}</p>
                    <div style="margin-top: 10px;">
                        <span class="status-pill ${idea.status === "do zrobienia" ? "todo" : idea.status === "w trakcie" ? "progress" : "done"}">${idea.status}</span>
                    </div>
                </div>
            `).join("");
        }

        function applyFilter(data, value, keys) {
            const lower = value.toLowerCase();
            return data.filter(item => keys.some(key => String(item[key]).toLowerCase().includes(lower)));
        }

        function attachSortHandlers(tableId, dataKey) {
            const table = document.getElementById(tableId);
            const headers = table.querySelectorAll("th[data-key]");

            headers.forEach(header => {
                header.addEventListener("click", () => {
                    const key = header.dataset.key;
                    if (state[`${dataKey}SortKey`] === key) {
                        state[`${dataKey}SortDir`] *= -1;
                    } else {
                        state[`${dataKey}SortKey`] = key;
                        state[`${dataKey}SortDir`] = 1;
                    }

                    const sorted = [...window[`${dataKey}Data`]].sort((a, b) => {
                        const valueA = a[key];
                        const valueB = b[key];

                        if (typeof valueA === "number") {
                            return (valueA - valueB) * state[`${dataKey}SortDir`];
                        }
                        return String(valueA).localeCompare(String(valueB), "pl") * state[`${dataKey}SortDir`];
                    });

                    if (dataKey === "niche") {
                        renderNicheTable(sorted);
                    }
                    if (dataKey === "keyword") {
                        renderKeywordTable(sorted);
                    }
                    if (dataKey === "monitor") {
                        renderMonitorTable(sorted);
                    }
                });
            });
        }

        function resetFilters(scope) {
            if (scope === "niche") {
                document.getElementById("nicheFilter").value = "";
                renderNicheTable(nicheData);
            }
            if (scope === "keyword") {
                document.getElementById("keywordFilter").value = "";
                renderKeywordTable(keywordData);
            }
            if (scope === "monitor") {
                document.getElementById("monitorFilter").value = "";
                renderMonitorTable(monitorData);
            }
        }

        document.getElementById("nicheFilter").addEventListener("input", (event) => {
            const filtered = applyFilter(nicheData, event.target.value, ["phrase", "category", "competition"]);
            renderNicheTable(filtered);
        });

        document.getElementById("keywordFilter").addEventListener("input", (event) => {
            const filtered = applyFilter(keywordData, event.target.value, ["phrase", "source", "competition", "usage"]);
            renderKeywordTable(filtered);
        });

        document.getElementById("monitorFilter").addEventListener("input", (event) => {
            const filtered = applyFilter(monitorData, event.target.value, ["niche", "alert"]);
            renderMonitorTable(filtered);
        });

        renderNicheTable(nicheData);
        renderNicheDetail();
        renderKeywordTable(keywordData);
        renderMonitorTable(monitorData);
        renderIdeas();

        attachSortHandlers("nicheTable", "niche");
        attachSortHandlers("keywordTable", "keyword");
        attachSortHandlers("monitorTable", "monitor");
    </script>
</body>
</html>
